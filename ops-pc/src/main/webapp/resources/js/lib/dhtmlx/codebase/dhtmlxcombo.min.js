function dhtmlXCombo(G,C,H,E,J){var F=this;var D=null;var I=null;if(typeof(G)=="object"&&!G.tagName){D=G;G=D.parent;H=D.width;C=D.name;E=D.mode;I=D.skin}this.cont=(typeof(G)=="string"?document.getElementById(G):G);this.conf={skin:null,form_name:C||"dhxcombo",combo_width:(parseInt(H)||this.cont.offsetWidth||120)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0),combo_image:false,combo_focus:false,opts_type:(typeof(E)=="string"&&typeof(this.modes[E])!="undefined"?E:"option"),opts_count:8,opts_count_min:5,opts_width:null,item_h:null,list_zi_id:window.dhx4.newId(),allow_free_text:true,allow_empty_value:true,free_text_empty:false,enabled:true,btn_left:((window.dhx4.isIE6||window.dhx4.isIE7||window.dhx4.isIE8)&&typeof(window.addEventListener)=="undefined"?1:0),ro_mode:false,ro_text:"",ro_tm:null,ro_tm_time:750,img_path:"",img_def:"",img_def_dis:true,template:{header:true,input:"#text#",option:"#text#"},f_func:null,f_mode:false,f_url:false,f_cache:false,f_cache_data:{},f_dyn:false,f_dyn_end:false,f_mask:"",f_ac:true,f_ac_text:"",f_server_tm:null,f_server_last:"",f_loading:false,s_tm:null,s_time:200,s_mode:"select",last_hover:null,last_selected:null,last_match:null,last_text:"",last_value:"",tm_hover:null,tm_confirm_blur:null,clear_click:false,clear_blur:false,clear_bsp:false,clear_key:false,i_ofs:23,sp:{dhx_skyblue:{list_ofs:1,hdr_ofs:1,scr_ofs:1},dhx_web:{list_ofs:0,hdr_ofs:1,scr_ofs:0},dhx_terrace:{list_ofs:1,hdr_ofs:1,scr_ofs:1},material:{list_ofs:0,hdr_ofs:1,scr_ofs:1}},col_w:null};this.conf.combo_image=(this.modes[this.conf.opts_type].image==true);this.t={};this.base=document.createElement("DIV");this.base.style.width=this.conf.combo_width+"px";this.base.innerHTML="<input type='text' class='dhxcombo_input' style='width:"+(this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0))+"px;"+(this.conf.combo_image?"margin-left:"+this.conf.i_ofs+"px;":"")+"' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>"+(this.conf.combo_image?"<div class='dhxcombo_top_image'>"+this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)+"</div>":"");this.cont.appendChild(this.base);this.list=document.createElement("DIV");this.list._listId=window.dhx4.newId();this.list.style.display="none";document.body.insertBefore(this.list,document.body.firstChild);this._doOnListScroll=function(){if(F.conf.s_tm!=null){window.clearTimeout(F.conf.s_tm)}F.conf.s_tm=window.setTimeout(F._doOnListScrollAction,F.conf.s_time)};this._doOnListScrollAction=function(){F.conf.s_tm=null;if(F.conf.s_mode=="scroll"&&F.list.scrollHeight-F.list.scrollTop-10<F.list.clientHeight){F._subloadRequest()}};if(typeof(window.addEventListener)=="function"){this.list.addEventListener("scroll",this._doOnListScroll,false)}else{this.list.attachEvent("onscroll",this._doOnListScroll)}this.setSkin(I||window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxcombo")||"material");this._updateTopImage=function(K){if(!this.conf.combo_image){return}if(K!=null){this.base.lastChild.innerHTML=this.t[K].obj.getTopImage(this.t[K].item,this.conf.enabled)}else{this.base.lastChild.innerHTML=this.modes[this.conf.opts_type].getTopImage(null,this.conf.enabled)}};this._filterOpts=function(R){if(this.conf.f_server_tm){window.clearTimeout(this.conf.f_server_tm)}var O=String(this.base.firstChild.value).replace(new RegExp(this._fixRE(this.conf.f_ac_text)+"$","i"),"");if(this.conf.f_server_last==O.toLowerCase()){this._checkForMatch();return}if(this.conf.f_url!=null&&this.checkEvent("onDynXLS")){this.conf.f_server_last=O.toLowerCase();this.callEvent("onDynXLS",[O]);return}if(this.conf.f_url!=null){if(O.length==0){this.conf.f_server_last=O.toLowerCase();this.clearAll();return}if(this.conf.f_cache==true&&this.conf.f_cache_data[O]!=null){this.clearAll();this.conf.f_server_last=O.toLowerCase();for(var L=0;L<this.conf.f_cache_data[O].data.length;L++){this.load(this.conf.f_cache_data[O].data[L])}if(this.conf.f_dyn){this.conf.f_dyn_end=this.conf.f_cache_data[O].dyn_end;this.conf.f_mask=this.conf.f_cache_data[O].mask}if(R!==true){this._showList(true);this._checkForMatch()}}else{this.conf.f_server_tm=window.setTimeout(function(){F.conf.f_server_last=O.toLowerCase();F.conf.f_mask=O;var U="mask="+encodeURIComponent(O);if(F.conf.f_dyn){U+="&pos=0";F.conf.f_dyn_end=false}var T=function(V){if(F.conf.f_cache){if(!F.conf.f_cache_data[O]){F.conf.f_cache_data[O]={data:[],dyn_end:false,mask:O}}F.conf.f_cache_data[O].data.push(V.xmlDoc.responseXML)}F.clearAll();F.load(V.xmlDoc.responseXML);var W=(F.base.offsetWidth>0&&F.base.offsetHeight>0);if(W==true&&F.conf.enabled==true&&F.conf.combo_focus==true&&R!==true){if(F.conf.f_ac&&F.conf.f_mode=="start"&&F.conf.clear_bsp==false&&F.list.firstChild!=null){var X=F.list.firstChild._optId;var Y=String(F.t[X].obj.getText(F.list.firstChild,true));if(O==F.base.firstChild.value&&String(Y).toLowerCase().indexOf(String(O).toLowerCase())===0){F.base.firstChild.value=Y;F.conf.f_ac_text=Y.substr(O.length);F._selectRange(O.length,Y.length)}}F._showList(true);F._checkForMatch()}T=null};if(window.dhx4.ajax.method=="post"){window.dhx4.ajax.post(F.conf.f_url,U,T)}else{if(window.dhx4.ajax.method=="get"){window.dhx4.ajax.get(F.conf.f_url+(String(F.conf.f_url).indexOf("?")>=0?"&":"?")+U,T)}}},200)}}else{this.conf.f_server_last=O.toLowerCase();var K=(O.length==0?true:new RegExp((this.conf.f_mode=="start"?"^":"")+this._fixRE(O),"i"));var N=null;for(var S in this.t){var M=false;if(K!==true){if(this.conf.f_func!=null){var Q=this._getOption(this.t[S].item._optId,L);M=(this.conf.f_func.apply(window,[O,Q])==true)}else{var P=this.t[S].obj.getText(this.t[S].item,true);M=(K.test(P)==true)}}if(K===true||M==true){this.t[S].item.style.display="";if(N==null&&O.length>0){N=String(this.t[S].obj.getText(this.t[S].item,true))}}else{this.t[S].item.style.display="none"}}if(this.conf.f_ac&&this.conf.f_mode=="start"&&this.conf.clear_bsp==false&&N!=null){this.conf.f_ac_text=N.replace(new RegExp("^"+O,"i"),"");this.base.firstChild.value=N;this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)}if(this.conf.f_mode=="between"&&this.conf.clear_bsp==true){this._checkForMatch(true)}if(R!==true){this._showList(true);this._checkForMatch()}}};this._searchRO=function(K){if(this.conf.ro_tm){window.clearTimeout(this.conf.ro_tm)}this.conf.ro_text+=K;this._showList();for(var L=0;L<this.list.childNodes.length;L++){var N=this.list.childNodes[L]._optId;var M=String(this.t[N].obj.getText(this.list.childNodes[L],true)).toLowerCase();if(M.indexOf(this.conf.ro_text)===0){this._setSelected(N,true,true);this._confirmSelect("script",false);break}}this.conf.ro_tm=window.setTimeout(function(){F.conf.ro_text=""},this.conf.ro_tm_time)};this._fixRE=function(K){return String(K).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi,"\\$&")};this._initObj=function(K){if(typeof(K.template)!="undefined"){this.setTemplate(K.template)}if(K.add!=true&&this.conf.f_loading!=true){this.clearAll(false)}this.addOption(K.options)};this._xmlToObj=function(V,Y,R){var N={add:false,options:[]};var U=(Y==true?V:V.getElementsByTagName("complete"));if(U.length>0){if(window.dhx4.s2b(U[0].getAttribute("add"))==true){N.add=true}var O=U[0].childNodes;for(var L=0;L<O.length;L++){if(typeof(O[L].tagName)!="undefined"){if(String(O[L].tagName).toLowerCase()=="template"){var c={};for(var M=0;M<O[L].childNodes.length;M++){var Q=O[L].childNodes[M];if(Q.tagName!=null){var X=Q.tagName;if(typeof(this.conf.template[X])!="undefined"){c[X]=window.dhx4._xmlNodeValue(Q)}if(X=="columns"){for(var T=0;T<Q.childNodes.length;T++){var Z=Q.childNodes[T];if(Z.tagName!=null&&Z.tagName=="column"){var W={};for(var S in {width:1,css:1,header:1,option:1}){if(Z.getAttribute(S)!=null){W[S]=Z.getAttribute(S)}}for(var S in {header:1,option:1}){var P=Z.getElementsByTagName(S);if(P[0]!=null&&P[0].firstChild!=null){W[S]=window.dhx4._xmlNodeValue(P[0])}}if(c.columns==null){c.columns=[]}c.columns.push(W)}Z=null}}}Q=null}this.setTemplate(c)}if(String(O[L].tagName).toLowerCase()=="option"){var K=false;if(Y==true){K=(N.options.length==R)}else{K=window.dhx4.s2b(O[L].getAttribute("selected"))}var b={value:O[L].getAttribute("value"),text:window.dhx4._xmlNodeValue(O[L]),selected:K,checked:window.dhx4.s2b(O[L].getAttribute("checked"))};for(var S in {img:1,img_dis:1,img_src:1,img_src_dis:1,css:1}){if(O[L].getAttribute(S)!=null){b[S]=O[L].getAttribute(S)}}for(var M=0;M<O[L].childNodes.length;M++){if(O[L].childNodes[M].tagName!=null&&String(O[L].childNodes[M].tagName).toLowerCase()=="text"){b.text={};var Q=O[L].childNodes[M];for(var T=0;T<Q.childNodes.length;T++){if(Q.childNodes[T].tagName!=null){b.text[Q.childNodes[T].tagName]=window.dhx4._xmlNodeValue(Q.childNodes[T])}}}}N.options.push(b)}}}U=O=null}return N};window.dhx4._enableDataLoading(this,"_initObj","_xmlToObj","complete",{data:true});window.dhx4._eventable(this);this._getNearItem=function(L,K){var M=null;while(L!=null){L=L[K<0?"previousSibling":"nextSibling"];if(M==null&&L!=null&&L.style.display==""&&L._optId!=null){M=L;L=null}}return M};this.setName(this.conf.form_name);this._doOnListMouseMove=function(K){K=K||event;var L=K.target||K.srcElement;while(L!=null&&L!=this){if(typeof(L._optId)!="undefined"){if(F.conf.tm_hover){window.clearTimeout(F.conf.tm_hover)}F._setSelected(L._optId,false,false,true)}L=L.parentNode}L=null};this._doOnListMouseDown=function(K){K=K||event;K.cancelBubble=true;F.conf.clear_click=true;window.setTimeout(function(){F.base.firstChild.focus()},1)};this._doOnListMouseUp=function(L){L=L||event;if(L.button!=F.conf.btn_left){return}var M=L.target||L.srcElement;while(M!=null&&M!=this){if(typeof(M._optId)!="undefined"){var K=true;if(typeof(F.t[M._optId].obj.optionClick)=="function"&&F.t[M._optId].obj.optionClick(M,L,F)!==true){K=false}if(K){F._setSelected(M._optId,null,true);F._confirmSelect("click");if(!!window.ActiveXObject||"ActiveXObject" in window){setTimeout(function(){F._hideList()},200)}else{F._hideList()}}}M=M.parentNode}M=null};this._doOnListMouseOut=function(K){K=K||event;if(F.conf.tm_hover){window.clearTimeout(F.conf.tm_hover)}F.conf.tm_hover=window.setTimeout(function(){var L=F.conf.last_match||F.conf.last_selected;if(F.conf.last_match==null&&F.t[L]!=null){if(F.base.firstChild.value!=F.t[L].obj.getText(F.t[L].item,true)){L=null}}if(K.relatedTarget&&$(K.relatedTarget).attr("class")?$(K.relatedTarget).attr("class").indexOf("mytoolsBar")==-1:true&&$(F.list).find($(K.relatedTarget)).length<=1&&F.list.className!=K.relatedTarget.className){F._setSelected(L,null,true,true)}},1)};this._doOnBaseMouseDown=function(K){if(!F.conf.enabled){return}F.conf.clear_click=true;K=K||event;if(K.button!=F.conf.btn_left){return}var N=K.target||K.srcElement;if(N!=this.firstChild){window.setTimeout(function(){F.mykey=1;F.base.firstChild.focus()},1);var L=N;while(L!=this&&L!=null){if(L==this.lastChild){if(typeof(F.modes[F.conf.opts_type].topImageClick)=="function"){var O=(F.conf.last_hover||F.conf.last_selected);var M=(O!=null?F.t[O].item:null);if(F.modes[F.conf.opts_type].topImageClick(M,F)!==true){O=M=null;return}}L=null}else{L=L.parentNode}}}if(F._isListVisible()){F._hideList()}else{if(N!=this.firstChild){F.conf.clear_blur=true}F._showList();F._setSelected(F.conf.last_selected,true,true)}N=null};this._doOnBodyMouseDown=function(){if(F.conf.clear_click){F.conf.clear_click=false;return}F._confirmSelect("blur")};this._doOnInputFocus=function(){F.conf.clear_blur=false;if(F.conf.tm_confirm_blur){window.clearTimeout(F.conf.tm_confirm_blur)}if(F.conf.combo_focus==false){F.conf.combo_focus=true;if(F.conf.skin=="material"&&F.base.className.match(/dhxcombo_actv/)==null){F.base.className+=" dhxcombo_actv"}F.callEvent("onFocus",[])}};this._doOnInputBlur=function(){if(F.conf.clear_blur==true){F.conf.clear_blur=false;return}if(F.conf.tm_confirm_blur){window.clearTimeout(F.conf.tm_confirm_blur)}F.conf.tm_confirm_blur=window.setTimeout(function(){if(F.conf.clear_click==false){F._confirmSelect("blur");F.conf.combo_focus=false;if(F.conf.skin=="material"&&F.base.className.match(/dhxcombo_actv/)!=null){F.base.className=F.base.className.replace(/\s*dhxcombo_actv/gi,"")}F.callEvent("onBlur",[])}},20)};this._doOnInputKeyUp=function(K){K=K||event;if(F.conf.f_mode!=false){F.conf.clear_bsp=(K.keyCode==8||K.keyCode==46);F._filterOpts();return}else{F._checkForMatch()}};this._doOnInputKeyDown=function(K){K=K||event;if((K.keyCode==38||K.keyCode==40)&&!K.ctrlKey&&!K.shiftKey&&!K.altKey){if(K.preventDefault){K.preventDefault()}else{K.returnValue=false}K.cancelBubble=true;F._keyOnUpDown(K.keyCode==38?-1:1)}if(K.keyCode==113){if(!F._isListVisible()){F._showList();if(F.base.firstChild.value==F.conf.last_text){F._setSelected(F.conf.last_selected,true,true);F.base.firstChild.value=F.conf.last_text;F.conf.f_server_last=F.base.firstChild.value.toLowerCase()}else{F.conf.f_server_last=F.base.firstChild.value.toLowerCase();if(F.conf.f_mode==false){F._checkForMatch()}}}else{}}if(K.keyCode==27){if(K.preventDefault){K.preventDefault()}else{K.returnValue=false}K.cancelBubble=true;F._cancelSelect()}if(K.keyCode==13){if(K.preventDefault){K.preventDefault()}F._confirmSelect("kbd")}if(F.conf.ro_mode==true&&((K.keyCode>=48&&K.keyCode<=57)||(K.keyCode>=65&&K.keyCode<=90))){F._searchRO(String.fromCharCode(K.keyCode).toLowerCase());K.cancelBubble=true}F.conf.clear_key=true;F.callEvent("onKeyPressed",[K.keyCode||K.charCode])};this._doOnInputKeyPress=function(K){if(F.conf.clear_key){F.conf.clear_key=false;return}K=K||event;F.callEvent("onKeyPressed",[K.keyCode||K.charCode])};this._keyOnUpDown=function(K){var L=null;if(this.conf.last_hover){L=this.t[this.conf.last_hover].item}else{if(this.conf.last_selected){L=this.t[this.conf.last_selected].item}}if(!L&&this._getListVisibleCount()==0){return}if(L!=null&&L.style.display!=""){L=null}this._showList();if(L!=null){if(this.t[L._optId].obj.isSelected(L)){L=this._getNearItem(L,K)}}else{L=this.list.firstChild;if(L.style.display!=""){L=this._getNearItem(L,1)}}if(L==null){return}this._setSelected(L._optId,true,true);if(this.conf.f_mode==false){this.base.firstChild.value=this.t[L._optId].obj.getText(L,true)}else{var M=String(this.t[L._optId].obj.getText(L,true));if(this.conf.f_mode=="start"&&this.conf.f_ac==true){if(M.toLowerCase().indexOf(this.conf.f_server_last)===0){this.conf.f_ac_text=M.substring(this.conf.f_server_last.length,M.length);this.base.firstChild.value=M;this._selectRange(this.conf.f_server_last.length,this.base.firstChild.value.length)}else{this.base.firstChild.value=M;this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this._selectRange(0,this.base.firstChild.value.length)}}else{this.base.firstChild.value=M;this.conf.f_server_last=this.base.firstChild.value.toLowerCase()}}L=null};this.conf.evs_nodes=[{node:document.body,evs:{mousedown:"_doOnBodyMouseDown"}},{node:this.base,evs:{mousedown:"_doOnBaseMouseDown"}},{node:this.base.firstChild,evs:{keyup:"_doOnInputKeyUp",keydown:"_doOnInputKeyDown",keypress:"_doOnInputKeyPress",focus:"_doOnInputFocus",blur:"_doOnInputBlur"}},{node:this.list,evs:{mousemove:"_doOnListMouseMove",mousedown:"_doOnListMouseDown",mouseup:"_doOnListMouseUp",mouseout:"_doOnListMouseOut"}}];for(var B=0;B<this.conf.evs_nodes.length;B++){for(var A in this.conf.evs_nodes[B].evs){if(typeof(window.addEventListener)=="function"){this.conf.evs_nodes[B].node.addEventListener(A,this[this.conf.evs_nodes[B].evs[A]],false)}else{this.conf.evs_nodes[B].node.attachEvent("on"+A,this[this.conf.evs_nodes[B].evs[A]])}}}this.unload=function(){this.clearAll();this.t=null;for(var K=0;K<this.conf.evs_nodes.length;K++){for(var L in this.conf.evs_nodes[K].evs){if(typeof(window.addEventListener)=="function"){this.conf.evs_nodes[K].node.removeEventListener(L,this[this.conf.evs_nodes[K].evs[L]],false)}else{this.conf.evs_nodes[K].node.detachEvent("on"+L,this[this.conf.evs_nodes[K].evs[L]])}this.conf.evs_nodes[K].evs[L]=null;delete this.conf.evs_nodes[K].evs[L]}this.conf.evs_nodes[K].node=null;this.conf.evs_nodes[K].evs=null;delete this.conf.evs_nodes[K].node;delete this.conf.evs_nodes[K].evs;this.conf.evs_nodes[K]=null}window.dhx4._eventable(this,"clear");window.dhx4._enableDataLoading(this,null,null,null,"clear");this._mcDetachHeader();this.DOMelem_input=this.DOMelem_button=this.DOMlist=this.DOMelem=this.DOMParent=null;for(var L in this.conf){this.conf[L]=null;delete this.conf[L]}this.conf=null;if(typeof(window.addEventListener)=="function"){this.list.removeEventListener("scroll",this._doOnListScroll,false)}else{this.list.detachEvent("onscroll",this._doOnListScroll)}this.base.parentNode.removeChild(this.base);this.list.parentNode.removeChild(this.list);this.base=this.list=this.cont=null;this.modes=null;for(var L in this){if(typeof(this[L])=="function"){this[L]=null}}F=null};this.DOMelem_input=this.base.firstChild;this.DOMelem_button=this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)];this.DOMlist=this.list;this.DOMelem=this.base;this.DOMParent=G;G=null;if(D!=null){if(D.filter!=null){if(typeof(D.filter)=="string"){this.enableFilteringMode(true,D.filter,window.dhx4.s2b(D.filter_cache),window.dhx4.s2b(D.filter_sub_load))}else{this.enableFilteringMode(true)}}if(D.image_path!=null){this.setImagePath(D.image_path)}if(D.default_image!=null||D.default_image_dis!=null){this.setDefaultImage(D.default_image,D.default_image_dis)}if(D.items||D.options){this.addOption(D.items||D.options)}if(D.xml||D.json){this.load(D.xml||D.json)}if(typeof(D.readonly)!="undefined"){this.readonly(D.readonly)}D=null}return this}function dhtmlXComboFromSelect(G){if(typeof(G)=="string"){G=document.getElementById(G)}var J=G.offsetWidth;var C=G.getAttribute("name")||null;var B=document.createElement("SPAN");G.parentNode.insertBefore(B,G);var A=G.getAttribute("mode")||G.getAttribute("opt_type")||"option";var H=new dhtmlXCombo(B,C,J,A);B=null;var F=G.getAttribute("imagePath");if(F){H.setImagePath(F)}var I=G.getAttribute("defaultImage");var D=G.getAttribute("defaultImageDis");if(window.dhx4.s2b(D)==true){D=true}if(I!=null||D!=null){H.setDefaultImage(I,D)}var E=H._xmlToObj([G],true,G.selectedIndex);if(E.options.length>0){H.addOption(E.options)}E=null;G.parentNode.removeChild(G);G=null;return H}dhtmlXCombo.prototype.setName=function(A){this.conf.form_name=A;this.base.childNodes[1].name=A;this.base.childNodes[2].name=A.replace(/(\[.*)?$/,"_new_value$1")};dhtmlXCombo.prototype.readonly=function(A){if(window.dhx4.s2b(A)){this.base.firstChild.setAttribute("readOnly","true");this.conf.ro_mode=true}else{this.base.firstChild.removeAttribute("readOnly");this.conf.ro_mode=false}};dhtmlXCombo.prototype.setPlaceholder=function(A){if(typeof(A)=="undefined"||A==null){A=""}this.base.firstChild.setAttribute("placeholder",String(A))};dhtmlXCombo.prototype.setTemplate=function(A){for(var B in A){if(typeof(this.conf.template[B])!="undefined"){if(B=="header"){this.conf.template[B]=window.dhx4.s2b(A[B])}else{this.conf.template[B]=String(A[B])}}}if(A.columns!=null){this._mcMakeTemplate(A.columns)}else{this._mcDetachHeader()}for(var B in this.t){this.t[B].obj.setText(this.t[B].item,this.t[B].item._conf.text)}this._confirmSelect()};dhtmlXCombo.prototype.setSkin=function(A){if(A==this.conf.skin){return}this.conf.skin=A;this.base.className="dhxcombo_"+this.conf.skin+(this.conf.enabled?"":" dhxcombo_disabled");this.list.className="dhxcombolist_"+this.conf.skin+(this.hdr!=null?" dhxcombolist_multicolumn":"");if(this.hdr!=null){this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr"}this.conf.i_ofs=(A=="material"?26:23);this._adjustBase()};dhtmlXCombo.prototype.getInput=function(){return this.base.firstChild};dhtmlXCombo.prototype.getButton=function(){return this.base.childNodes[this.base.childNodes.length-(this.conf.combo_image?2:1)]};dhtmlXCombo.prototype.getList=function(){return this.list};dhtmlXCombo.prototype.getBase=function(){return this.base};dhtmlXCombo.prototype.getParent=function(){return this.DOMParent};dhtmlXCombo.prototype.forEachOption=function(A){for(var B=0;B<this.list.childNodes.length;B++){A.apply(window,[this._getOption(this.list.childNodes[B]._optId,B)])}};dhtmlXCombo.prototype.setFocus=function(){if(this.conf.enabled){this.base.firstChild.focus()}};dhtmlXCombo.prototype.setFontSize=function(A,B){if(A!=null){this.base.firstChild.style.fontSize=A}if(B!=null){this.list.style.fontSize=B}};dhtmlXCombo.prototype.getOption=function(C){var E=null;var A=null;for(var B=0;B<this.list.childNodes.length;B++){if(E==null){var D=this.list.childNodes[B]._optId;if(!D){continue}if(this.t[D].obj.getValue(this.t[D].item)==C){E=D;A=B}}}return(E==null?null:this._getOption(E,A))};dhtmlXCombo.prototype.getOptionByIndex=function(A){if(A<0){return null}if(this.list.childNodes[A]==null){return null}return this._getOption(this.list.childNodes[A]._optId,A)};dhtmlXCombo.prototype.getOptionByLabel=function(B){var E=null;var C=null;for(var A=0;A<this.list.childNodes.length;A++){if(E==null){var D=this.list.childNodes[A]._optId;if(this.t[D].obj.getText(this.t[D].item,true)==B){E=D;C=A}}}return(E==null?null:this._getOption(E,C))};dhtmlXCombo.prototype.getSelectedIndex=function(){return this._getOptionProp(this.conf.last_selected,"index",-1)};dhtmlXCombo.prototype.getSelectedText=function(){return this._getOptionProp(this.conf.last_selected,"text","")};dhtmlXCombo.prototype.getSelectedValue=function(){return this._getOptionProp(this.conf.temp_selected||this.conf.last_selected,"value",null)};dhtmlXCombo.prototype.getActualValue=function(){return this.base.childNodes[1].value};dhtmlXCombo.prototype.getComboText=function(){return this.base.childNodes[0].value};dhtmlXCombo.prototype.getIndexByValue=function(A){var B=this.getOption(A);return(B!=null?B.index:-1)};dhtmlXCombo.prototype.setComboText=function(A){if(this.conf.allow_free_text!=true){return}this.unSelectOption();this.conf.last_text=this.base.firstChild.value=A;this.conf.f_server_last=this.base.firstChild.value.toLowerCase()};dhtmlXCombo.prototype.setComboValue=function(A){var B=this.getOption(A);if(B!=null){this.selectOption(B.index)}else{this.conf.last_value=A;this.base.childNodes[1].value=this.conf.last_value;this.base.childNodes[2].value="true"}};dhtmlXCombo.prototype.selectOption=function(C,B,A){if(C<0||C>=this.list.childNodes.length){return}var D=this.list.childNodes[C]._optId;this._setSelected(D,this._isListVisible(),true);this._confirmSelect("script")};dhtmlXCombo.prototype.unSelectOption=function(){if(this.conf.last_hover!=null){this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,false);this.conf.last_hover=null}this.base.firstChild.value="";if(this.conf.f_mode!=false){this._filterOpts(true)}this._hideList();this._updateTopImage(null);this._confirmSelect("script")};dhtmlXCombo.prototype.confirmValue=function(){this._confirmSelect("script")};dhtmlXCombo.prototype.enable=function(A){A=(typeof(A)=="undefined"?true:window.dhx4.s2b(A));if(this.conf.enabled==A){return}this.conf.enabled=A;if(A){this.base.className="dhxcombo_"+this.conf.skin;this.base.firstChild.removeAttribute("disabled")}else{this._hideList();this.base.className="dhxcombo_"+this.conf.skin+" dhxcombo_disabled";this.base.firstChild.setAttribute("disabled","true")}this._updateTopImage(this.conf.last_selected)};dhtmlXCombo.prototype.disable=function(A){A=(typeof(A)=="undefined"?true:window.dhx4.s2b(A));this.enable(!A)};dhtmlXCombo.prototype.isEnabled=function(){return(this.conf.enabled==true)};dhtmlXCombo.prototype.show=function(A){if(typeof(A)=="undefined"){A=true}else{A=window.dhx4.s2b(A)}this.base.style.display=(A==true?"":"none")};dhtmlXCombo.prototype.hide=function(A){if(typeof(A)=="undefined"){A=true}this.show(!A)};dhtmlXCombo.prototype.isVisible=function(){return(this.base.style.display=="")};dhtmlXCombo.prototype.setFilterHandler=function(A){if(typeof(A)=="function"){this.conf.f_func=A;this.conf.f_mode=true;this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null}else{if(typeof(A)=="string"&&typeof(window[A])=="function"){this.conf.f_func=window[A];this.conf.f_mode=true;this.conf.f_dyn=this.conf.f_cache=this.conf.f_url=null}else{this.conf.f_func=null}}};dhtmlXCombo.prototype.enableFilteringMode=function(B,D,A,C){if(B==true||B=="between"){this.conf.f_mode=(B==true?"start":"between");if(D!=null){this.conf.f_url=D;this.conf.f_cache=window.dhx4.s2b(A);this.conf.f_dyn=window.dhx4.s2b(C)}else{this.conf.f_url=null;this.conf.f_cache=false;this.conf.f_dyn=false}}else{this.conf.f_mode=false;this.conf.f_url=null;this.conf.f_cache=false;this.conf.f_dyn=false}};dhtmlXCombo.prototype.filter=function(A,C){for(var B=0;B<this.list.childNodes.length;B++){var D=A.apply(window,[this._getOption(this.list.childNodes[B]._optId,B)]);this.list.childNodes[B].style.display=(D===true?"":"none")}if(typeof(C)=="undefined"||C==true){this._showList(true)}};dhtmlXCombo.prototype.sort=function(B){var A=[];for(var C=0;C<this.list.childNodes.length;C++){var D=this.list.childNodes[C]._optId;A.push([D,this._getOption(D,C)])}if(B=="asc"||B=="desc"){k=true;A.sort(function(G,F){G=G[1].text_option.toLowerCase();F=F[1].text_option.toLowerCase();var E=(B=="asc"?1:-1);return(G>F?E:-1*E)})}else{if(typeof(B)=="function"||typeof(window[B])=="function"){if(typeof(window[B])=="function"){B=window[B]}A.sort(function(F,E){return B.apply(window,[F[1],E[1]])})}}while(this.list.childNodes.length>0){this.list.removeChild(this.list.lastChild)}for(var C=0;C<A.length;C++){this.list.appendChild(this.t[A[C][0]].item)}};dhtmlXCombo.prototype.enableAutocomplete=function(A){if(typeof(A)=="undefined"){A=true}else{A=window.dhx4.s2b(A)}this.conf.f_ac=A};dhtmlXCombo.prototype.disableAutocomplete=function(A){if(typeof(A)=="undefined"){A=true}else{A=window.dhx4.s2b(A)}this.enableAutocomplete(!A)};dhtmlXCombo.prototype.allowFreeText=function(A,B){this.conf.allow_free_text=(typeof(A)=="undefined"?true:window.dhx4.s2b(A));this.conf.free_text_empty=(typeof(B)=="undefined"?false:window.dhx4.s2b(B))};dhtmlXCombo.prototype._checkForMatch=function(A){var E=window.dhx4.trim(this.base.firstChild.value).toLowerCase();var C=null;var B=this.list.firstChild;while(B!=null){if(B.style.display==""&&B._optId!=null){var D=window.dhx4.trim(this.t[B._optId].obj.getText(B,true)).toLowerCase();if(E==D){C=B._optId;B=null}}if(B!=null){B=B.nextSibling}}if(this.conf.last_match==null){if(C!=null){this._setSelected(C,true,true);this.conf.last_match=C}else{if(this.conf.f_mode!="between"||A==true){this._setSelected(null,true,true);this.conf.last_match=null}}}else{if(C!=null){if(C!=this.conf.last_match){this._setSelected(C,true,true);this.conf.last_match=C}}else{this._setSelected(null,true,true);this.conf.last_match=null}}};dhtmlXCombo.prototype._selectRange=function(A,B){if(this.conf.combo_focus==true){window.dhx4.selectTextRange(this.base.firstChild,A,B)}};dhtmlXCombo.prototype.openSelect=function(){if(!this._isListVisible()){this._showList()}};dhtmlXCombo.prototype.closeAll=function(){this._hideList()};dhtmlXCombo.prototype._showList=function(B){if(this._getListVisibleCount()==0){if(B&&this._isListVisible()){this._hideList()}return}if(this._isListVisible()){this._checkListHeight();return}this.list.style.zIndex=window.dhx4.zim.reserve(this.conf.list_zi_id);if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.zIndex=Number(this.list.style.zIndex)+1}this.list.style.visibility="hidden";this.list.style.display="";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.visibility=this.list.style.visibility;this.hdr.style.display=this.list.style.display}var A=(this.hdr!=null&&this.conf.template.header==true?this.hdr.offsetHeight:0);this.list.style.width=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width)+"px";this.list.style.top=window.dhx4.absTop(this.base)+A+this.base.offsetHeight-1+"px";var D=Math.max(this.conf.opts_width||this.conf.col_w||0,this.conf.combo_width);var C=$(window).outerWidth();this.list.style.left=D+window.dhx4.absLeft(this.base)>C?C-D+"px":window.dhx4.absLeft(this.base)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.width=this.list.style.width;this.hdr.style.left=this.list.style.left;this.hdr.style.top=parseInt(this.list.style.top)-A+"px"}this._checkListHeight();this.list.style.visibility="visible";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.visibility="visible"}this.callEvent("onOpen",[])};dhtmlXCombo.prototype._hideList=function(){if(!this._isListVisible()){return}window.dhx4.zim.clear(this.conf.list_zi_id);this.list.style.display="none";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.display="none"}this.conf.clear_click=false;this.callEvent("onClose",[])};dhtmlXCombo.prototype._isListVisible=function(){return(this.list.style.display=="")};dhtmlXCombo.prototype._getListVisibleCount=function(){var B=0;for(var A=0;A<this.list.childNodes.length;A++){B+=(this.list.childNodes[A].style.display==""?1:0)}return B};dhtmlXCombo.prototype._checkListHeight=function(){if(!this._isListVisible()){return}if(this.conf.item_h==null){var K=this.list.firstChild;while(K!=null){if(K.style.display==""){this.conf.item_h=K.offsetHeight+(this.hdr!=null?-1:0);K=null}else{K=K.nextSibling}}K=null}var C=window.dhx4.screenDim();var D=window.dhx4.absTop(this.base);var F=this.base.offsetHeight;var B=(this.hdr!=null&&this.conf.template.header==true?this.hdr.offsetHeight:0);var G=Math.max(0,Math.floor((D+B-C.top)/this.conf.item_h));var A=Math.max(0,Math.floor((C.bottom-(D+F+B))/this.conf.item_h));if($(this.hdr).find(".myAdd").length>0){A=Math.max(0,Math.floor((C.bottom-(D+F+B)-78)/this.conf.item_h))}if($(this.list).find(".mytoolsBar").length>0){A=Math.max(0,Math.floor((C.bottom-(D+F+B)-42)/this.conf.item_h))}var I=this._getListVisibleCount();if(A<Math.min(this.conf.opts_count_min,I)&&G>A){A=null}var J=Math.min((A==null?G:A),this.conf.opts_count,I);var H=(J<I?(J*this.conf.item_h)+"px":"");var E=this.conf.sp[this.conf.skin][this.hdr!=null&&this.conf.template.header==true?"hdr_ofs":"list_ofs"];this.list.style.height=H;this.list.style.top=(A==null?D-this.list.offsetHeight+E:D+F+B-E)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.top=(A==null?D-B-this.list.offsetHeight+E:D+F-E)+"px"}if($(this.hdr).find(".myAdd").length>0){this.list.style.top=(A==null?D-this.list.offsetHeight+E-78:D+F+B-E)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.top=(A==null?D-B-this.list.offsetHeight+E-78:D+F-E)+"px"}}if($(this.list).find(".mytoolsBar").length>0){this.list.style.top=(A==null?D-this.list.offsetHeight+E-42:D+F+B-E)+"px";if(this.hdr!=null&&this.conf.template.header==true){this.hdr.style.top=(A==null?D-B-this.list.offsetHeight+E-42:D+F-E)+"px"}}};dhtmlXCombo.prototype._scrollToItem=function(E){var D=this.t[E].item.offsetTop;var B=D+this.t[E].item.offsetHeight;var A=this.list.scrollTop;var C=A+this.list.clientHeight;if(D<A){this.list.scrollTop=D+(this.hdr!=null&&this.conf.template.header==true?1:0)}else{if(B>C){this.list.scrollTop=B-this.list.clientHeight+(this.hdr!=null&&this.conf.template.header==true?-this.conf.sp[this.conf.skin].scr_ofs:0)}}};dhtmlXCombo.prototype._setSelected=function(D,C,B,A){this.conf.temp_selected=null;if(B){this._updateTopImage(D)}if(D!=null&&this.conf.last_hover==D){if(C){this._scrollToItem(D)}return}if(this.conf.last_hover!=null){this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item,false);this.conf.last_hover=null;if(D==null){this.callEvent("onSelectionChange",[])}}if(D!=null){this.t[D].obj.setSelected(this.t[D].item,true);this.conf.last_hover=D;if(A!=true){this.conf.temp_selected=D;this.callEvent("onSelectionChange",[])}if(this.conf.s_mode=="select"&&this.t[D].item==this.t[D].item.parentNode.lastChild){this._subloadRequest()}if(C){this._scrollToItem(D)}}};dhtmlXCombo.prototype._subloadRequest=function(){if(this.conf.f_url!=null&&this.conf.f_dyn==true&&this.conf.f_dyn_end==false){var C="mask="+encodeURIComponent(this.conf.f_mask)+"&pos="+this.list.childNodes.length;var B=this;var A=function(D){if(B.conf.f_cache){B.conf.f_cache_data[B.conf.f_mask].data.push(D.xmlDoc.responseXML)}var E=B.list.childNodes.length;B.conf.f_loading=true;B.load(D.xmlDoc.responseXML);B.conf.f_loading=false;if(E==B.list.childNodes.length){B.conf.f_dyn_end=true;if(B.conf.f_cache){B.conf.f_cache_data[B.conf.f_mask].dyn_end=true}}A=B=null};if(window.dhx4.ajax.method=="post"){window.dhx4.ajax.post(this.conf.f_url,C,A)}else{if(window.dhx4.ajax.method=="get"){window.dhx4.ajax.get(this.conf.f_url+(String(this.conf.f_url).indexOf("?")>=0?"&":"?")+C,A)}}}};dhtmlXCombo.prototype.addOption=function(E,G,B,A,F){var C=null;if(!(E instanceof Array)){var H=this._renderOption({value:E,text:G,css:B,img:A});if(C==null&&window.dhx4.s2b(F)==true){C=H}}else{for(var D=0;D<E.length;D++){if(typeof(E[D])=="undefined"){continue}if(E[D] instanceof Array){H=this._renderOption({value:E[D][0],text:E[D][1],css:E[D][2],img:E[D][3]});if(C==null&&window.dhx4.s2b(E[D][4])==true){C=H}}else{var H=this._renderOption(E[D]);if(C==null&&window.dhx4.s2b(E[D].selected)==true){C=H}}}}if(C!=null){this._setSelected(C,this._isListVisible(),true);this._confirmSelect("onInit")}};dhtmlXCombo.prototype.updateOption=function(A,E,C,B){var D=this._getOptionId(A);if(D==null){return}this.t[D].obj.update(this.t[D].item,{value:E,text:C,css:B});if(this.conf.last_selected==D){this.conf.last_text=this.base.firstChild.value=this.t[D].obj.getText(this.t[D].item,true);this.conf.f_server_last=this.base.firstChild.value.toLowerCase()}};dhtmlXCombo.prototype.deleteOption=function(B){for(var C in this.t){var A=this.t[C].obj.getValue(this.t[C].item);if(A==B){this._removeOption(C)}}if(this._isListVisible()){this._showList(true)}};dhtmlXCombo.prototype.clearAll=function(B){B=(typeof(B)=="undefined"?true:window.dhx4.s2b(B));for(var A in this.t){this._removeOption(A)}if(this.conf.tm_hover){window.clearTimeout(this.conf.tm_hover)}this.conf.last_hover=null;this.conf.last_selected=null;this.list.scrollTop=0;if(B==true){this._hideList()}};dhtmlXCombo.prototype._renderOption=function(E){var D=window.dhx4.newId();var B=document.createElement("DIV");B._optId=D;B._tpl=this.conf.template;if(typeof(E.img)=="undefined"&&typeof(E.img_src)!="undefined"){E.img=E.img_src;delete E.img_src}if(typeof(E.img_dis)=="undefined"&&typeof(E.img_src_dis)!="undefined"){E.img_dis=E.img_src_dis;delete E.img_src_dis}E.img_path=this.conf.img_path;E.img_def=this.conf.img_def;E.img_def_dis=this.conf.img_def_dis;this.list.appendChild(B);var C=(this._isListVisible()&&window.dhx4.isFF==true);if(C==true){var A=this.list.scrollTop;this.list.scrollTop-=1}if(this.hdr!=null){E.multicol=true}this.t[B._optId]={obj:this.modes[this.conf.opts_type].render(B,E),item:B,conf:{type:this.conf.opts_type}};B=null;if(C==true){this.list.scrollTop+=1}return D};dhtmlXCombo.prototype._removeOption=function(A){this.t[A].obj.destruct(this.t[A].item);this.t[A].obj=null;this.t[A].item.parentNode.removeChild(this.t[A].item);this.t[A].item=null;this.t[A].conf=null;this.t[A]=null;delete this.t[A];if(this.conf.last_hover==A){this.conf.last_hover=null}if(this.conf.last_selected==A){this.conf.last_selected=null;this._confirmSelect("onDelete")}};dhtmlXCombo.prototype._confirmSelect=function(B,C){var A=false;if(typeof(C)=="undefined"){C=true}if(this.conf.f_server_tm){window.clearTimeout(this.conf.f_server_tm)}if(this.base.firstChild==null){return}if(this.conf.last_hover!=null){A=A||(this.conf.last_value!=this._getOptionValue(this.conf.last_hover));this.conf.last_match=this.conf.last_selected=this.conf.last_hover;this.conf.last_value=this._getOptionValue(this.conf.last_selected);this.conf.last_text=this.base.firstChild.value=this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item,true);this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this.base.childNodes[1].value=this.conf.last_value;this.base.childNodes[2].value="false"}else{if(this.conf.allow_free_text||(this.base.firstChild.value==""&&this.conf.allow_empty_value)){A=A||(this.conf.last_text!=this.base.firstChild.value);this.conf.last_match=this.conf.last_value=this.conf.last_selected=null;this.conf.last_text=this.base.firstChild.value;this.conf.f_server_last=this.base.firstChild.value.toLowerCase();this.base.childNodes[1].value=this.conf.last_text;this.base.childNodes[2].value="true"}else{this._cancelSelect(true);this._updateTopImage(this.conf.last_selected);return}}if(this.conf.f_ac&&this.conf.f_mode=="start"){this.conf.f_ac_text="";if(B!="blur"){this._selectRange(this.base.firstChild.value.length,this.base.firstChild.value.length)}}if(C){this._hideList()}if(A==true&&B!="onInit"&&B!="onDelete"){this.callEvent("onSelectionChange",[]);this.callEvent("onChange",[this.conf.last_value,this.conf.last_text])}};dhtmlXCombo.prototype._cancelSelect=function(A){this._hideList();if(A==true&&this.conf.allow_free_text==false&&this.conf.free_text_empty==true){this.conf.f_server_last=this.conf.last_match=this.conf.last_value=this.conf.last_selected=null;this.base.childNodes[1].value=this.conf.last_text=this.base.firstChild.value="";this.base.childNodes[2].value="false"}else{this.base.firstChild.value=this.conf.last_text}if(this.conf.f_mode!=false){this._filterOpts(true)}};dhtmlXCombo.prototype._getOption=function(F,C){if(!this.t[F]){return null}if(typeof(C)=="undefined"){C=-1}if(C<0){for(var B=0;B<this.list.childNodes.length;B++){if(C<0&&this.list.childNodes[B]._optId==F){C=B}}}var D={value:this.t[F].obj.getValue(this.t[F].item),text:this.t[F].obj.getText(this.t[F].item),text_input:this.t[F].obj.getText(this.t[F].item,true),text_option:this.t[F].obj.getText(this.t[F].item,null,true),css:this.t[F].obj.getCss(this.t[F].item),selected:(F==this.conf.last_selected),index:C};if(typeof(this.t[F].obj.getExtraData)=="function"){var A=this.t[F].obj.getExtraData(this.t[F].item);for(var E in A){if(typeof(D[E])=="undefined"){D[E]=A[E]}}}return D};dhtmlXCombo.prototype._getOptionProp=function(D,A,C){if(D!=null){var B=this._getOption(D);if(B!=null){return B[A]}}return C};dhtmlXCombo.prototype._getOptionId=function(C){var D=null;for(var B=0;B<this.list.childNodes.length;B++){if(D==null){var A=this.list.childNodes[B]._optId;if(C==this.t[A].obj.getValue(this.t[A].item)){D=A}}}return D};dhtmlXCombo.prototype._getOptionValue=function(A){return this._getOptionProp(A,"value",null)};dhtmlXCombo.prototype.setSize=function(A){this.conf.combo_width=parseInt(A)-(dhx4.isFF||dhx4.isIE||dhx4.isChrome||dhx4.isOpera?2:0);this.base.style.width=Math.max(0,this.conf.combo_width)+"px";this._adjustBase()};dhtmlXCombo.prototype._adjustBase=function(){this.base.firstChild.style.width=Math.max(0,(this.conf.combo_width-(this.conf.i_ofs+1)-(this.conf.combo_image?this.conf.i_ofs:0)))+"px";this.base.firstChild.style.marginLeft=(this.conf.combo_image?this.conf.i_ofs+"px":"0px")};dhtmlXCombo.prototype.setOptionWidth=function(A){this.conf.opts_width=(parseInt(A)||null)};dhtmlXCombo.prototype.setOptionIndex=function(C,A){if(isNaN(A)||A<0){return}var B=this.getOption(C);if(B==null){return}if(A==B.index){return}var D=this.list.childNodes[B.index];D.parentNode.removeChild(D);if(this.list.childNodes[A]!=null){this.list.insertBefore(D,this.list.childNodes[A])}else{this.list.appendChild(D)}D=null};dhtmlXCombo.prototype.getOptionsCount=function(){return this.list.childNodes.length};dhtmlXCombo.prototype._mcMakeTemplate=function(F){var E="";var C="";this.conf.col_w=0;for(var A=0;A<F.length;A++){var B=Number(parseInt(F[A].width)||50);var H=(F[A].css||"");var G=(A==0&&window.dhx4.isIE6==true?"_first":"");C+="<div class='dhxcombo_cell"+G+" "+H+"' style='width:"+B+"px;'><div class='dhxcombo_cell_text' title='"+(F[A].option||"&nbsp;")+"'>"+(F[A].option||"&nbsp;")+"</div></div>";E+="<div class='dhxcombo_hdrcell"+G+" "+H+"' style='width:"+B+"px;'><div class='dhxcombo_hdrcell_text'>"+(F[A].header||"&nbsp;")+"</div></div>";this.conf.col_w+=B+1}var B=500;var D=document.createElement("DIV");D.style.position="absolute";D.style.top="10px";D.style.left=-B*2+"px";D.style.width=B+"px";D.style.height="50px";D.style.overflowY="scroll";D.innerHTML="<div>&nbsp;</div>";document.body.appendChild(D);this.conf.col_w+=B-D.firstChild.offsetWidth+10;D.parentNode.removeChild(D);D=null;this.conf.template.option=C;this._mcAttachHeader(E);this.list.className+=" dhxcombolist_multicolumn"};dhtmlXCombo.prototype._mcAttachHeader=function(A){if(this.hdr==null){this.hdr=document.createElement("DIV");this.hdr.className="dhxcombolist_"+this.conf.skin+" dhxcombolist_hdr";this.hdr.style.display="none";this.list.parentNode.insertBefore(this.hdr,this.list);if(typeof(window.addEventListener)=="function"){this.hdr.addEventListener("mousedown",this._doOnListMouseDown,false)}else{this.hdr.attachEvent("onmousedown",this._doOnListMouseDown)}if(this.conf.opts_type=="checkbox"&&this.conf.combo_image==true){this.conf.combo_image=false;if(this.base.lastChild.className.match(/dhxcombo_top_image/)!=null){this.base.removeChild(this.base.lastChild)}this._adjustBase()}}this.hdr.innerHTML="<div class='dhxcombo_hdrtext'>"+A+"</div>"};dhtmlXCombo.prototype._mcDetachHeader=function(){if(this.hdr!=null){if(typeof(window.addEventListener)=="function"){this.hdr.removeEventListener("mousedown",this._doOnListMouseDown,false)}else{this.hdr.detachEvent("onmousedown",this._doOnListMouseDown)}this.hdr.parentNode.removeChild(this.hdr);this.hdr=null}this.conf.col_w=null;this.conf.item_h=null};dhtmlXCombo.prototype.modes={};dhtmlXCombo.prototype.doWithItem=function(D,C,B,E){var G=(D>=0&&D<this.list.childNodes.length?this.list.childNodes[D]._optId:null);if(G==null){return null}if(typeof(this.t[G].obj[C])!="function"){return null}var F=[this.t[G].item];for(var A=2;A<arguments.length;A++){F.push(arguments[A])}return this.t[G].obj[C].apply(this.t[G].obj,F)};function dhtmlXComboExtend(B,A){for(var C in dhtmlXCombo.prototype.modes[A]){if(typeof(dhtmlXCombo.prototype.modes[B][C])=="undefined"){dhtmlXCombo.prototype.modes[B][C]=dhtmlXCombo.prototype.modes[A][C]}}}dhtmlXCombo.prototype.modes.option={image:false,html:false,option_css:"dhxcombo_option_text",render:function(A,B){A._conf={value:B.value,css:""};A.className="dhxcombo_option";A.innerHTML="<div class='"+this.option_css+"'>&nbsp;</div>";if(B.css!=null){A.lastChild.style.cssText=B.css;A._conf.css=B.css}if(typeof B.text.child!="undefined"){$(A).find(".dhxcombo_option_text").addClass("dhx_childOption"+B.text.child)}if(typeof B.text.mypar!="undefined"&&B.text.mypar==1){$(A).find(".dhxcombo_option_text").addClass("dhx_parOption")}this.setText(A,B.text);return this},destruct:function(A){A._conf=null},update:function(A,B){A._conf.value=B.value;A._conf.css=B.css;A.lastChild.style.cssText=B.css;this.setText(A,B.text)},setText:function(A,C){A._conf.text=C;var B=(typeof(C)=="object"?window.dhx4.template(A._tpl.option,this.replaceHtml(A._conf.text),true):window.dhx4.trim(this.replaceHtml(A._conf.text)||""));A.lastChild.innerHTML=(B.length==0?"&nbsp;":B)},getText:function(A,C,B){if(window.dhx4.s2b(C)&&typeof(A._conf.text)=="object"){return window.dhx4.template(A._tpl.input,A._conf.text,true).replace(/&nbsp;/,"")}if(window.dhx4.s2b(B)&&typeof(A._conf.text)=="object"){return window.dhx4.template(A._tpl.option,A._conf.text,true)}return A._conf.text},getValue:function(A){return A._conf.value},getCss:function(A){return A._conf.css},setSelected:function(A,B){A.className="dhxcombo_option"+(B?" dhxcombo_option_selected":"")},isSelected:function(A){return String(A.className).indexOf("dhxcombo_option_selected")>=0},getExtraData:function(A){return{type:"option"}},replaceHtml:function(A){if(this.html==true){return A}if(typeof(A)=="object"){if(A==null){return""}var B={};for(var C in A){B[C]=this.replaceHtml(A[C])}}else{if(typeof(A)=="string"){var B=(A||"").replace(/[\<\>\&\s]/g,function(D){switch(D){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case" ":return"&nbsp;"}return D})}else{if(typeof(A)=="number"){return A}}}return B}};dhtmlXCombo.prototype.modes.checkbox={image:true,html:false,image_css:"dhxcombo_checkbox dhxcombo_chbx_#state#",option_css:"dhxcombo_option_text dhxcombo_option_text_chbx",render:function(A,B){if(this.image_css_regexp==null){this.image_css_regexp=new RegExp(this.image_css.replace("#state#","\\d*"))}A._conf={value:B.value,css:"",checked:window.dhx4.s2b(B.checked)};A.className="dhxcombo_option";if(B.multicol==true){B.text.checkbox="<div class='"+String(this.image_css).replace("#state#",(A._conf.checked?"1":"0"))+"'></div>&nbsp;";A.innerHTML="<div class='"+dhtmlXCombo.prototype.modes.option.option_css+"'></div>"}else{A.innerHTML="<div class='"+String(this.image_css).replace("#state#",(A._conf.checked?"1":"0"))+"'></div><div class='"+this.option_css+"'>&nbsp;</div>"}if(B.css!=null){A.lastChild.style.cssText+=B.css;A._conf.css=B.css}this.setText(A,B.text);return this},setChecked:function(A,C){A._conf.checked=window.dhx4.s2b(C);var B=String(this.image_css).replace("#state#",(A._conf.checked?"1":"0"));this._changeChbxCss(A.childNodes,B)},_changeChbxCss:function(C,B){for(var A=0;A<C.length;A++){if(C[A].tagName!=null&&C[A].className!=null&&C[A].className.match(this.image_css_regexp)!=null){C[A].className=B}else{if(C[A].childNodes.length>0){this._changeChbxCss(C[A].childNodes,B)}}}},isChecked:function(A){return(A._conf.checked==true)},getExtraData:function(A){return{type:"checkbox",checked:A._conf.checked}},optionClick:function(C,E,B){var A=true;var D=(E.target||E.srcElement);while(A==true&&D!=null&&D!=C&&D.className!=null){if(D.className.match(this.image_css_regexp)!=null){var F=[C._conf.value,!C._conf.checked];if(B.callEvent("onBeforeCheck",F)===true){this.setChecked(C,!this.isChecked(C));B.callEvent("onCheck",F)}A=false;F=null}else{D=D.parentNode}}D=B=C=null;return A},getTopImage:function(A,B){return""},topImageClick:function(A,B){return true}};dhtmlXComboExtend("checkbox","option");dhtmlXCombo.prototype.setChecked=function(B,A){this.doWithItem(B,"setChecked",A)};dhtmlXCombo.prototype.getChecked=function(B){var C=[];for(var A=0;A<this.list.childNodes.length;A++){if(this.isChecked(A)){C.push(this._getOptionProp(this.list.childNodes[A]._optId,"value",""))}}return C};dhtmlXCombo.prototype.isChecked=function(A){return this.doWithItem(A,"isChecked")};dhtmlXCombo.prototype.modes.image={image:true,html:false,image_css:"dhxcombo_image",option_css:"dhxcombo_option_text dhxcombo_option_text_image",render:function(A,B){A._conf={value:B.value,css:""};A.className="dhxcombo_option";A.innerHTML="<div class='"+this.image_css+"'></div><div class='"+this.option_css+"'>&nbsp;</div>";if(B.css!=null){A.lastChild.style.cssText+=B.css;A._conf.css=B.css}this.setText(A,B.text);this.setImage(A,B.img,B.img_dis,B.img_path,B.img_def,B.img_def_dis);return this},update:function(A,B){A._conf.value=B.value;A._conf.css=B.css;A.lastChild.style.cssText=B.css;this.setText(A,B.text);this.setImage(A,B.img,B.img_dis,B.img_path,B.img_def,B.img_def_dis)},setImage:function(B,E,C,F,D,A){if(E!=null&&E.length>0){E=F+E}else{if(D!=null&&D.length>0){E=F+D}else{E=null}}if(C!=null&&C.length>0){C=F+C}else{if(A!=null&&A.length>0){C=F+A}else{if(A==true){C=E}else{C=null}}}B._conf.img=E;B._conf.img_dis=C;B.firstChild.style.backgroundImage=(E!=null?"url("+E+")":"none")},getExtraData:function(A){return{type:"image"}},getTopImage:function(B,C){var A=(C?"img":"img_dis");if(B!=null&&B._conf[A]!=null){return"<div class='"+this.image_css+"' style='background-image:url("+B._conf[A]+");'></div>"}return""}};dhtmlXComboExtend("image","option");dhtmlXCombo.prototype.setDefaultImage=function(B,A){if(B!=null){this.conf.img_def=B}if(A!=null){this.conf.img_def_dis=A}};dhtmlXCombo.prototype.setImagePath=function(A){this.conf.img_path=A};